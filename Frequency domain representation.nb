(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30539,        671]
NotebookOptionsPosition[     29691,        637]
NotebookOutlinePosition[     30067,        653]
CellTagsIndexPosition[     30024,        650]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"fft", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "img", ",", " ", "fft", ",", "fd", ",", "min", ",", "max", ",", 
      "phase"}], "}"}], ",", 
    RowBox[{
     RowBox[{"img", "=", 
      RowBox[{"RemoveAlphaChannel", "[", 
       RowBox[{"Import", "[", "\"\<C:\\\\in.tiff\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fft", "=", 
      RowBox[{"Fourier", "[", 
       RowBox[{"ImageData", "[", "img", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fft", "=", 
      RowBox[{"RotateLeft", "[", 
       RowBox[{"fft", ",", 
        RowBox[{"Floor", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "fft", "]"}], " ", "/", " ", "2"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fd", " ", "=", " ", 
      RowBox[{"Log", "[", 
       RowBox[{
        RowBox[{"Abs", "[", "fft", "]"}], "-", 
        RowBox[{"10.", "^", 
         RowBox[{"-", "10"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"min", " ", "=", " ", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{"Min", "[", "fd", "]"}], ",", "12"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"max", " ", "=", " ", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{"Max", "[", "fd", "]"}], ",", "12"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fd", " ", "=", " ", 
      RowBox[{
       RowBox[{"Rescale", "[", "fd", "]"}], "*", "256"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"phase", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Arg", "[", "fft", "]"}], "+", "Pi"}], ")"}], " ", "/", 
         " ", 
         RowBox[{"(", 
          RowBox[{"2", "Pi"}], ")"}]}], ")"}], "*", "256"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"\"\<C:\\\\fft.tiff\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Image\>\"", "->", 
          RowBox[{"Image", "[", 
           RowBox[{"fd", ",", "\"\<Byte\>\""}], "]"}]}], ",", 
         RowBox[{"\"\<ImageEncoding\>\"", "\[Rule]", "\"\<LZW\>\""}]}], "}"}],
        ",", "\"\<Rules\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"\"\<C:\\\\phase.tiff\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Image\>\"", "->", 
          RowBox[{"Image", "[", 
           RowBox[{"phase", ",", "\"\<Byte\>\""}], "]"}]}], ",", 
         RowBox[{"\"\<ImageEncoding\>\"", "\[Rule]", "\"\<LZW\>\""}]}], "}"}],
        ",", "\"\<Rules\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"\"\<C:\\\\fft.json\>\"", ",", 
       RowBox[{"ExportString", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<koeff_lo\>\"", "\[Rule]", "min"}], ",", 
           RowBox[{"\"\<koeff_hi\>\"", "\[Rule]", "max"}]}], "}"}], ",", 
         "\"\<JSON\>\"", ",", 
         RowBox[{"\"\<Compact\>\"", "\[Rule]", "True"}]}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "fft"}], "Input",
 CellChangeTimes->{{3.6895945416463194`*^9, 3.68959456964192*^9}, {
   3.689594724314767*^9, 3.689594763855029*^9}, {3.6896012638088045`*^9, 
   3.689601297127711*^9}, {3.6896013586972322`*^9, 3.6896014138803883`*^9}, {
   3.6896021875916424`*^9, 3.689602191671876*^9}, {3.689696407191546*^9, 
   3.6896964303178687`*^9}, {3.689696550607749*^9, 3.6896965785513473`*^9}, {
   3.6896966924468613`*^9, 3.689696698854228*^9}, {3.689696801246084*^9, 
   3.6896968286066494`*^9}, {3.6896968647587175`*^9, 3.689696952805753*^9}, {
   3.689697074359706*^9, 3.689697120032318*^9}, {3.689697185702074*^9, 
   3.689697245263481*^9}, {3.6896972870308695`*^9, 3.689697306990011*^9}, {
   3.689697341637993*^9, 3.6896973970861645`*^9}, {3.6896974429987907`*^9, 
   3.6896975256225166`*^9}, {3.6896975593834476`*^9, 
   3.6896975790955753`*^9}, {3.689697638230957*^9, 3.6896976626383533`*^9}, {
   3.6896978915664473`*^9, 3.6896980009107018`*^9}, {3.689698057903961*^9, 
   3.6896981337743006`*^9}, {3.6896981904795437`*^9, 3.689698200982145*^9}, {
   3.689698302622958*^9, 3.689698377567245*^9}, {3.6896994645054145`*^9, 
   3.6896994802883167`*^9}, {3.6896995329903316`*^9, 
   3.6896996494159904`*^9}, {3.6896997252543283`*^9, 3.689699968288229*^9}, {
   3.689700065703801*^9, 3.6897000754083557`*^9}, {3.689700216585431*^9, 
   3.68970033789837*^9}, {3.689700379065724*^9, 3.689700411545582*^9}, 
   3.6897004415632987`*^9, 3.689701994279109*^9, {3.689702028023039*^9, 
   3.689702417936341*^9}, {3.6897024843801413`*^9, 3.689702511888715*^9}, {
   3.689702747768206*^9, 3.6897027781769457`*^9}, {3.6897028209043894`*^9, 
   3.689702908104377*^9}, {3.689703211391724*^9, 3.689703236447157*^9}, {
   3.6897032771224833`*^9, 3.689703417335503*^9}, {3.689703460239957*^9, 
   3.689703502631382*^9}, {3.6897035479749756`*^9, 3.6897035894153457`*^9}, {
   3.689703626105444*^9, 3.689703684007756*^9}, {3.6897037319354973`*^9, 
   3.6897037702166867`*^9}, {3.689703802697545*^9, 3.689703802889556*^9}, {
   3.6897038351684017`*^9, 3.6897038421368003`*^9}, {3.6897038910736*^9, 
   3.6897039193682175`*^9}, {3.6897039550742598`*^9, 3.6897039596095195`*^9}, 
   3.689704010216414*^9, {3.6897040545599504`*^9, 3.68970412553601*^9}, {
   3.68970418585746*^9, 3.6897042755515904`*^9}, {3.6897043994876795`*^9, 
   3.689704539510688*^9}, {3.689704672183276*^9, 3.6897046913273716`*^9}, {
   3.6897048666724005`*^9, 3.6897050208002157`*^9}, {3.689705252424464*^9, 
   3.6897052747357407`*^9}, {3.68970530690458*^9, 3.6897053533282356`*^9}, {
   3.689705533120519*^9, 3.689705533327531*^9}, {3.689705611585007*^9, 
   3.68970564537594*^9}, {3.689705731415861*^9, 3.689705763640704*^9}, {
   3.68970582109099*^9, 3.6897058264152946`*^9}, {3.68970586217634*^9, 
   3.689705870767832*^9}, {3.6897059017276025`*^9, 3.6897059148243513`*^9}, {
   3.6897059619470468`*^9, 3.68970602301854*^9}, {3.689706079587775*^9, 
   3.68970608054283*^9}, {3.6897061347029276`*^9, 3.6897061350939503`*^9}, {
   3.6897063288230305`*^9, 3.6897063433288603`*^9}, {3.689706432070936*^9, 
   3.6897064325349627`*^9}, {3.6897065326636896`*^9, 
   3.6897065672886705`*^9}, {3.6897067380224357`*^9, 
   3.6897067519362316`*^9}, {3.689706785147131*^9, 3.689706785968178*^9}, {
   3.689706923008016*^9, 3.6897069295503902`*^9}, {3.6897070266079416`*^9, 
   3.689707047297125*^9}, {3.689707147615863*^9, 3.689707166761958*^9}, {
   3.689707208881367*^9, 3.6897072338737965`*^9}, {3.689707342938035*^9, 
   3.689707414657137*^9}, {3.689707450002158*^9, 3.689707554786152*^9}, {
   3.689707912058587*^9, 3.689707949762743*^9}, {3.6897080336735425`*^9, 
   3.6897081084588203`*^9}, {3.689708156468566*^9, 3.6897081610258265`*^9}, {
   3.6897082532511015`*^9, 3.6897082937074156`*^9}, {3.689708512987958*^9, 
   3.6897085170591908`*^9}, {3.6897086472526374`*^9, 3.68970870517095*^9}, {
   3.6897114743063354`*^9, 3.6897114819947753`*^9}, {3.689711595108245*^9, 
   3.6897115955392694`*^9}, {3.689711656587762*^9, 3.689711700683284*^9}, {
   3.6897121142749395`*^9, 3.6897121548752623`*^9}, {3.6897121958376045`*^9, 
   3.689712196147622*^9}, {3.6897125883330545`*^9, 3.689712591788252*^9}, 
   3.689741420107375*^9, {3.68974268233957*^9, 3.6897426831056137`*^9}, {
   3.6897427201027303`*^9, 3.6897427350645857`*^9}, {3.689743151506405*^9, 
   3.6897431597558765`*^9}, {3.6897434603230686`*^9, 
   3.6897434718587284`*^9}, {3.6897435469310217`*^9, 
   3.6897435470980315`*^9}, {3.689743601746157*^9, 3.6897436066034355`*^9}, {
   3.68974390967377*^9, 3.6897439312280025`*^9}, {3.6897440240033092`*^9, 
   3.689744030649689*^9}, {3.692361844696184*^9, 3.692361851686584*^9}, {
   3.692362525968151*^9, 3.692362527255224*^9}, {3.692364596465576*^9, 
   3.6923645974796343`*^9}, {3.692369299856595*^9, 3.692369300415627*^9}, {
   3.692369467248169*^9, 3.6923694716964235`*^9}, {3.6923767998645706`*^9, 
   3.6923768000065794`*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.689711515781708*^9, 3.6897117136220236`*^9, 3.689712174091361*^9, 
   3.6897122347618313`*^9, 3.6897407855890827`*^9, 3.6897414266707497`*^9, 
   3.6897415649896617`*^9, {3.6897416050749545`*^9, 3.6897416349556637`*^9}, 
   3.6897418162300315`*^9, 3.6897425584744854`*^9, 3.6897425926534405`*^9, 
   3.6897426598392835`*^9, 3.689742805640623*^9, 3.6897428799418726`*^9, 
   3.689743168879399*^9, 3.6897434790681405`*^9, 3.689743611293703*^9, 
   3.6897436977826505`*^9, 3.6897437593081694`*^9, 3.6897439363652964`*^9, 
   3.6897440097484937`*^9, 3.6897440401822343`*^9, 3.6897441337405853`*^9, 
   3.6897442068707685`*^9, 3.6897442869523487`*^9, 3.689844514830604*^9, 
   3.689844617232461*^9, 3.689844677581913*^9, {3.6898447286928363`*^9, 
   3.689844790811389*^9}, 3.6898451401473703`*^9, 3.692361853028661*^9, 
   3.692361915967261*^9, 3.6923620676879387`*^9, 3.692362263994167*^9, 
   3.692362336625321*^9, 3.6923625436731634`*^9, 3.6923627252205477`*^9, 
   3.692362808455308*^9, 3.6923628621583796`*^9, 3.692362897169382*^9, {
   3.6923629783330245`*^9, 3.6923629827342763`*^9}, {3.692363118908065*^9, 
   3.692363131824804*^9}, 3.6923631618895235`*^9, 3.6923633500312843`*^9, 
   3.69236341376693*^9, {3.6923634565273757`*^9, 3.6923635051591573`*^9}, {
   3.6923635524368615`*^9, 3.6923635786063585`*^9}, 3.6923642190139875`*^9, 
   3.6923642797184596`*^9, {3.6923645011451244`*^9, 3.692364521794306*^9}, {
   3.6923645701130695`*^9, 3.692364582137757*^9}, {3.692364652804799*^9, 
   3.6923646691297326`*^9}, 3.6923647010365577`*^9, {3.692364759196884*^9, 
   3.692364776794891*^9}, 3.692364829011877*^9, {3.692364860770694*^9, 
   3.6923649656026897`*^9}, 3.6923650885247207`*^9, {3.69236519289069*^9, 
   3.692365214372919*^9}, {3.6923653211760273`*^9, 3.692365345535421*^9}, {
   3.6923653875498238`*^9, 3.692365436294612*^9}, {3.692365495108976*^9, 
   3.692365519588376*^9}, {3.692365650996892*^9, 3.6923656883180265`*^9}, 
   3.692365751431637*^9, {3.6923658079938717`*^9, 3.692365911342783*^9}, 
   3.6923659729293056`*^9, {3.692366029593547*^9, 3.692366063653495*^9}, {
   3.6923661182496176`*^9, 3.6923661558397675`*^9}, 3.6923662021344156`*^9, {
   3.6923662508162003`*^9, 3.6923662653550315`*^9}, {3.6923663232623434`*^9, 
   3.692366366019789*^9}, 3.6923665391636925`*^9, {3.6923666078966236`*^9, 
   3.6923666452207584`*^9}, 3.692366729307568*^9, 3.692366772547041*^9, 
   3.6923668059409513`*^9, 3.692366863183225*^9, 3.6923668991322813`*^9, 
   3.6923669292210026`*^9, 3.692366962292894*^9, 3.6923670408293858`*^9, 
   3.692367140117065*^9, 3.692367213044236*^9, 3.6923673130029535`*^9, 
   3.6923673943206043`*^9, 3.6923674505648212`*^9, 3.69236799777612*^9, 
   3.692368058840613*^9, 3.6923683588477726`*^9, {3.692368453759201*^9, 
   3.6923684778825808`*^9}, 3.692368516294778*^9, 3.692368577558282*^9, 
   3.692369037088566*^9, 3.692369099948161*^9, 3.6923691449547353`*^9, {
   3.6923691779476223`*^9, 3.692369202491026*^9}, 3.6923693206937866`*^9, 
   3.6923694218025703`*^9, 3.6923694779017787`*^9, 3.6923695366971416`*^9, 
   3.6923696361698313`*^9, 3.692376577795869*^9, 3.6923793028167315`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ifft", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fd", ",", "phase", ",", "koeffs", ",", " ", "result"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fd", " ", "=", " ", 
      RowBox[{"ImageData", "[", 
       RowBox[{"Import", "[", 
        RowBox[{"\"\<C:\\\\fft.tiff\>\"", ",", "\"\<Image\>\""}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"koeffs", " ", "=", " ", 
      RowBox[{"Association", "[", 
       RowBox[{"ImportString", "[", 
        RowBox[{
         RowBox[{"Import", "[", "\"\<C:\\\\fft.json\>\"", "]"}], ",", 
         "\"\<JSON\>\""}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"phase", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"ImageData", "[", 
         RowBox[{"Import", "[", "\"\<C:\\\\phase.tiff\>\"", "]"}], "]"}], "*",
         "2", "*", "Pi"}], " ", "-", " ", "Pi"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"fd", "+", 
             RowBox[{"10.", "^", 
              RowBox[{"-", "10"}]}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"koeffs", "[", "\"\<koeff_hi\>\"", "]"}], "-", 
             RowBox[{"koeffs", "[", "\"\<koeff_lo\>\"", "]"}]}], ")"}]}], "-", 
          RowBox[{"Abs", "[", 
           RowBox[{"koeffs", "[", "\"\<koeff_lo\>\"", "]"}], "]"}]}], "]"}], 
        ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", "phase", "]"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"Sin", "[", "phase", "]"}], " ", "I"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"Abs", "[", 
       RowBox[{"InverseFourier", "[", 
        RowBox[{"RotateRight", "[", 
         RowBox[{"result", ",", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", "result", "]"}], " ", "/", " ", "2"}], 
           "]"}]}], "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"\"\<C:\\\\out.tiff\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Image\>\"", "->", 
          RowBox[{"Image", "[", 
           RowBox[{
            RowBox[{"result", "*", "256"}], ",", "\"\<Byte\>\""}], "]"}]}], 
         ",", 
         RowBox[{"\"\<ImageEncoding\>\"", "\[Rule]", "\"\<ZIP\>\""}]}], "}"}],
        ",", "\"\<Rules\>\""}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", "ifft"}], "Input",
 CellChangeTimes->{{3.6897061863998847`*^9, 3.689706250182533*^9}, {
   3.6897063723755217`*^9, 3.689706415590994*^9}, {3.6897064865670533`*^9, 
   3.689706519252923*^9}, {3.6897069663744965`*^9, 3.6897069665265055`*^9}, {
   3.689708795818135*^9, 3.6897088715524664`*^9}, {3.689708902856257*^9, 
   3.689708903208277*^9}, {3.689709284857106*^9, 3.6897093884650326`*^9}, {
   3.689709505185708*^9, 3.6897095448329763`*^9}, {3.6897095993770957`*^9, 
   3.6897095995771074`*^9}, {3.6897096508250384`*^9, 
   3.6897097049771357`*^9}, {3.689711044656761*^9, 3.689711100287943*^9}, {
   3.689711375408679*^9, 3.6897114141938972`*^9}, {3.6897115181938457`*^9, 
   3.689711518880885*^9}, {3.689711751915214*^9, 3.689711757642542*^9}, {
   3.6897117964357605`*^9, 3.6897118584823093`*^9}, {3.6897119476594095`*^9, 
   3.689712030801165*^9}, {3.689712104026354*^9, 3.6897121053854313`*^9}, 
   3.689712252417841*^9, {3.689712452954311*^9, 3.68971245783359*^9}, {
   3.689712509003517*^9, 3.6897125176980143`*^9}, {3.6897125939783773`*^9, 
   3.6897126004817495`*^9}, {3.689739960871911*^9, 3.6897399750867243`*^9}, {
   3.6897400531531897`*^9, 3.689740080590759*^9}, {3.6897427414489512`*^9, 
   3.689742751904549*^9}, {3.69236258347044*^9, 3.6923626104049807`*^9}, {
   3.692362687957416*^9, 3.692362688236432*^9}, {3.6923766721762676`*^9, 
   3.6923767459904895`*^9}, {3.6923793308023324`*^9, 3.69237933356649*^9}}],

Cell[BoxData["\<\"C:\\\\out.tiff\"\>"], "Output",
 CellChangeTimes->{
  3.692362691562622*^9, 3.692362727748692*^9, 3.692362763698748*^9, 
   3.6923628212580404`*^9, 3.6923628683917365`*^9, 3.6923629015816345`*^9, {
   3.6923629809671755`*^9, 3.6923629850254073`*^9}, 3.6923631822716894`*^9, {
   3.6923634395264034`*^9, 3.6923634590185184`*^9}, 3.6923635816765337`*^9, {
   3.6923642314576993`*^9, 3.692364282419614*^9}, {3.692364655778969*^9, 
   3.6923646722789125`*^9}, {3.6923647037867146`*^9, 3.692364730469241*^9}, 
   3.69236478534938*^9, 3.6923648319020424`*^9, 3.692366399712716*^9, 
   3.6923665433919344`*^9, 3.6923666489389715`*^9, 3.6923667334458046`*^9, 
   3.6923667762402525`*^9, 3.692366866145395*^9, 3.6923669019484425`*^9, 
   3.6923669355553646`*^9, 3.692367044639604*^9, 3.6923671430892353`*^9, 
   3.6923671823034782`*^9, 3.6923672193305955`*^9, {3.692367316038127*^9, 
   3.692367331708023*^9}, 3.6923674084974155`*^9, 3.692367456162142*^9, 
   3.6923675346426306`*^9, 3.692368001465331*^9, 3.692368377670849*^9, 
   3.6923691049934497`*^9, 3.6923695681499405`*^9, 3.692376615498026*^9, {
   3.6923767019199686`*^9, 3.6923767478935986`*^9}, 3.6923793065489454`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"img1", "=", 
   RowBox[{"Import", "[", "\"\<C:\\\\phase.tiff\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"img2", "=", 
   RowBox[{"Import", "[", "\"\<C:\\\\fft.tiff\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cut`r", "=", ".25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vert`bars", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ColorSpace1", " ", "=", 
   RowBox[{
    RowBox[{"Association", "[", 
     RowBox[{"Options", "[", "img1", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Key", "[", "ColorSpace", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"img1", "=", 
   RowBox[{"ImageMultiply", "[", 
    RowBox[{"img1", ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Black", ",", 
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", "cut`r"}], "]"}], ",", 
         "White", ",", 
         RowBox[{"Rectangle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{
              RowBox[{"-", "cut`r"}], "*", "vert`bars"}]}], "}"}]}], "]"}], 
         ",", 
         RowBox[{"Rectangle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"cut`r", "*", "vert`bars"}]}], "}"}]}], "]"}]}], "}"}], 
       ",", 
       RowBox[{"ImagePadding", "\[Rule]", "None"}], ",", 
       RowBox[{"ImageMargins", "\[Rule]", "0"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", "None"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"img2", "=", 
   RowBox[{"ImageMultiply", "[", 
    RowBox[{"img2", ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Black", ",", 
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", "cut`r"}], "]"}], ",", 
         "White", ",", 
         RowBox[{"Rectangle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{
              RowBox[{"-", "cut`r"}], "*", "vert`bars"}]}], "}"}]}], "]"}], 
         ",", 
         RowBox[{"Rectangle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"cut`r", "*", "vert`bars"}]}], "}"}]}], "]"}]}], "}"}], 
       ",", 
       RowBox[{"ImagePadding", "\[Rule]", "None"}], ",", 
       RowBox[{"ImageMargins", "\[Rule]", "0"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", "None"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"ColorSpace1", "\[Equal]", "\"\<Grayscale\>\""}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"img1", "=", 
     RowBox[{
      RowBox[{"ConformImages", "[", 
       RowBox[{
        RowBox[{"{", "img1", "}"}], ",", 
        RowBox[{"ColorSpace", "\[Rule]", "\"\<Grayscale\>\""}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"img2", "=", 
     RowBox[{
      RowBox[{"ConformImages", "[", 
       RowBox[{
        RowBox[{"{", "img2", "}"}], ",", 
        RowBox[{"ColorSpace", "\[Rule]", "\"\<Grayscale\>\""}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<C:\\\\phase.tiff\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Image\>\"", "->", 
      RowBox[{"Image", "[", 
       RowBox[{"img1", ",", "\"\<Byte\>\"", ",", 
        RowBox[{"ColorSpace", "\[Rule]", "ColorSpace1"}]}], "]"}]}], ",", 
     RowBox[{"\"\<ImageEncoding\>\"", "\[Rule]", "\"\<ZIP\>\""}]}], "}"}], 
   ",", "\"\<Rules\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<C:\\\\fft.tiff\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<Image\>\"", "->", 
       RowBox[{"Image", "[", 
        RowBox[{"img2", ",", "\"\<Byte\>\"", ",", 
         RowBox[{"ColorSpace", "\[Rule]", "ColorSpace1"}]}], "]"}]}], ",", 
      RowBox[{"\"\<ImageEncoding\>\"", "\[Rule]", "\"\<ZIP\>\""}]}], "}"}], 
    ",", "\"\<Rules\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.68974022660511*^9, 3.6897402306443415`*^9}, {
   3.6897404199571695`*^9, 3.689740423308361*^9}, {3.689740508484233*^9, 
   3.689740519203846*^9}, {3.6897405586851044`*^9, 3.6897405647564516`*^9}, {
   3.6897408305006514`*^9, 3.6897408307166634`*^9}, {3.6897409710546904`*^9, 
   3.689740986989602*^9}, {3.6897411061904197`*^9, 3.6897411105726705`*^9}, 
   3.6897413039417305`*^9, 3.6897413615170236`*^9, {3.689741404621489*^9, 
   3.6897414135650005`*^9}, {3.6897414861961546`*^9, 
   3.6897415009639997`*^9}, {3.689741551277877*^9, 3.689741554773077*^9}, {
   3.689741597269508*^9, 3.6897416282282786`*^9}, {3.689741704092618*^9, 
   3.6897417418527775`*^9}, {3.6897417851582546`*^9, 
   3.6897417876843987`*^9}, {3.689741830572852*^9, 3.6897418373162374`*^9}, {
   3.6897418885571685`*^9, 3.6897419028609867`*^9}, {3.68974194995868*^9, 
   3.6897419503007*^9}, 3.6897420173335342`*^9, {3.6897421105988684`*^9, 
   3.6897421432687373`*^9}, {3.6897422306937375`*^9, 3.689742265108706*^9}, {
   3.6897423369578156`*^9, 3.6897423379088697`*^9}, {3.6897423831814594`*^9, 
   3.68974256118064*^9}, {3.6897426157737627`*^9, 3.6897426645815544`*^9}, {
   3.689742848391068*^9, 3.6897428649490147`*^9}, {3.689742926823554*^9, 
   3.689742927333583*^9}, {3.689743237295312*^9, 3.689743237910347*^9}, {
   3.689743706767164*^9, 3.6897437107023892`*^9}, {3.68974374603041*^9, 
   3.6897437556059575`*^9}, {3.6898446763328414`*^9, 
   3.6898447902973595`*^9}, {3.689845100443099*^9, 3.689845195937561*^9}, {
   3.692362075067361*^9, 3.6923620932354*^9}, {3.692362123619138*^9, 
   3.6923621284194126`*^9}, {3.6923622661002874`*^9, 3.692362272842673*^9}, {
   3.6923623488040175`*^9, 3.69236236336285*^9}, {3.6923625157955685`*^9, 
   3.692362520625845*^9}, {3.6923627176751156`*^9, 3.6923627213393254`*^9}, {
   3.6923627520600824`*^9, 3.6923627589784784`*^9}, {3.692362812795556*^9, 
   3.692362818369875*^9}, {3.6923628535638885`*^9, 3.692362856163037*^9}, {
   3.6923630900274134`*^9, 3.6923631588103476`*^9}, {3.6923633019405336`*^9, 
   3.6923633176514325`*^9}, {3.6923633725265713`*^9, 3.69236337373164*^9}, {
   3.692363404653409*^9, 3.692363409971713*^9}, {3.6923634544762583`*^9, 
   3.69236350135594*^9}, {3.6923635426203003`*^9, 3.6923635758512006`*^9}, {
   3.692364207660338*^9, 3.69236421538678*^9}, {3.6923642472046003`*^9, 
   3.6923642912271175`*^9}, {3.6923643233559556`*^9, 
   3.6923643435321093`*^9}, {3.692364482732071*^9, 3.692364519349166*^9}, {
   3.692364558532407*^9, 3.6923645924853487`*^9}, {3.6923646665235834`*^9, 
   3.6923647699725003`*^9}, {3.692364821805465*^9, 3.692364981252585*^9}, {
   3.692365026669183*^9, 3.6923651064387455`*^9}, {3.6923651831491327`*^9, 
   3.6923652120767875`*^9}, {3.6923652685480175`*^9, 
   3.6923653430522785`*^9}, {3.6923653844526467`*^9, 3.692365434405504*^9}, {
   3.69236548923664*^9, 3.692365517677267*^9}, {3.6923656274365444`*^9, 
   3.6923657612842007`*^9}, {3.6923657930860195`*^9, 3.692365977476566*^9}, {
   3.6923660179488807`*^9, 3.6923662006293297`*^9}, {3.692366245933921*^9, 
   3.6923662637819414`*^9}, {3.6923663190531025`*^9, 3.692366364236687*^9}, {
   3.6923665178144712`*^9, 3.6923665358775043`*^9}, {3.692366600238186*^9, 
   3.692366642380596*^9}, {3.6923667618154273`*^9, 3.6923667691418467`*^9}, {
   3.6923668026887655`*^9, 3.692366858669967*^9}, {3.6923668937269726`*^9, 
   3.692367038140232*^9}, {3.6923671254232244`*^9, 3.692367137534917*^9}, {
   3.6923671792223015`*^9, 3.6923673230225267`*^9}, {3.692367390670396*^9, 
   3.6923673925495033`*^9}, {3.6923674424143553`*^9, 
   3.6923674478526664`*^9}, {3.6923675886467195`*^9, 3.692367641214726*^9}, {
   3.692367677573806*^9, 3.6923677472957935`*^9}, {3.6923678872477984`*^9, 
   3.6923681060143113`*^9}, {3.692368156160179*^9, 3.6923683756187315`*^9}, {
   3.6923684107217393`*^9, 3.692368513828637*^9}, {3.692368611174205*^9, 
   3.6923686251560044`*^9}, {3.692368720771473*^9, 3.69236873977956*^9}, {
   3.6923689867026834`*^9, 3.692369027445014*^9}, {3.6923690937898088`*^9, 
   3.692369097053995*^9}, {3.6923695408403783`*^9, 3.6923695468077197`*^9}}],

Cell[BoxData["\<\"C:\\\\phase.tiff\"\>"], "Output",
 CellChangeTimes->{{3.6923680537583227`*^9, 3.692368060329698*^9}, 
   3.692368113359731*^9, 3.6923681662497563`*^9, 3.692368201067748*^9, {
   3.6923682323795385`*^9, 3.6923682584700313`*^9}, {3.6923683607218795`*^9, 
   3.692368379097931*^9}, {3.6923684171571074`*^9, 3.6923684783456073`*^9}, 
   3.6923685184809027`*^9, {3.692368556857098*^9, 3.692368579401387*^9}, {
   3.6923690398507233`*^9, 3.6923690484342146`*^9}, 3.6923691029043303`*^9, 
   3.692369518013073*^9, 3.6923695528910675`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["\"\<C:\\\\fft.tiff\>\""], "Input",
 CellChangeTimes->{3.692365262912695*^9}],

Cell[BoxData["\<\"C:\\\\fft.tiff\"\>"], "Output",
 CellChangeTimes->{3.692365262945697*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Black", ",", 
     RowBox[{"Rectangle", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}]}], "}"}], "*", ".5"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "*", ".5"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"ImagePadding", "\[Rule]", "None"}], ",", 
   RowBox[{"ImageMargins", "\[Rule]", "0"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", "None"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics", "[", 
  RowBox[{"{", 
   RowBox[{"Black", ",", 
    RowBox[{"Disk", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", "White", ",", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", ".4"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", ".4"}], "}"}]}], "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6923664196498566`*^9, 3.6923664809393625`*^9}}],

Cell[BoxData[
 GraphicsBox[
  {GrayLevel[0], RectangleBox[{-0.5, -0.5}]},
  ImageMargins->0,
  ImagePadding->None,
  PlotRange->{-1, 1},
  PlotRangePadding->None]], "Output",
 CellChangeTimes->{
  3.692364310205203*^9, {3.6923664169767036`*^9, 3.6923664239121003`*^9}, {
   3.692366460499193*^9, 3.692366493186063*^9}}],

Cell[BoxData[
 GraphicsBox[{
   {GrayLevel[0], DiskBox[{0, 0}]}, 
   {GrayLevel[1], RectangleBox[{-1, -1}, {1, -0.4}], 
    RectangleBox[{-1, 1}, {1, 0.4}]}},
  ImageMargins->0]], "Output",
 CellChangeTimes->{
  3.692364310205203*^9, {3.6923664169767036`*^9, 3.6923664239121003`*^9}, {
   3.692366460499193*^9, 3.6923664931920633`*^9}}]
}, Open  ]]
},
WindowSize->{1440, 834},
WindowMargins->{{-4, Automatic}, {Automatic, -4}},
Magnification:>0.9 Inherited,
FrontEndVersion->"10.0 for Microsoft Windows (32-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 8079, 151, 270, "Input"],
Cell[8662, 175, 3197, 44, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11896, 224, 4101, 88, 190, "Input"],
Cell[16000, 314, 1189, 16, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17226, 335, 9491, 209, 310, "Input"],
Cell[26720, 546, 549, 7, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27306, 558, 90, 1, 29, "Input"],
Cell[27399, 561, 91, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27527, 567, 1487, 46, 50, "Input"],
Cell[29017, 615, 319, 9, 402, "Output"],
Cell[29339, 626, 336, 8, 271, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
